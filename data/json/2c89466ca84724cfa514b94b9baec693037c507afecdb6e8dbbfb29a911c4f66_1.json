{"ast":null,"code":"import React,{useRef,useEffect}from'react';import{useStore}from'../../store/useStore';import{jsx as _jsx}from\"react/jsx-runtime\";export const Timeline=()=>{const{tracks,currentTime,tempo,timeSignature}=useStore();const canvasRef=useRef(null);// Calculate grid based on tempo and time signature\nconst beatsPerBar=timeSignature[0];const pixelsPerBeat=50;const pixelsPerBar=pixelsPerBeat*beatsPerBar;useEffect(()=>{const canvas=canvasRef.current;if(!canvas)return;const ctx=canvas.getContext('2d');if(!ctx)return;// Set canvas size\ncanvas.width=canvas.offsetWidth;canvas.height=canvas.offsetHeight;// Draw background\nctx.fillStyle='#1a1a1a';ctx.fillRect(0,0,canvas.width,canvas.height);// Draw grid lines\nconst bars=Math.ceil(canvas.width/pixelsPerBar);for(let i=0;i<=bars*beatsPerBar;i++){const x=i*pixelsPerBeat;const isBar=i%beatsPerBar===0;ctx.strokeStyle=isBar?'#444':'#2a2a2a';ctx.lineWidth=isBar?2:1;ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,canvas.height);ctx.stroke();// Bar numbers\nif(isBar){ctx.fillStyle='#666';ctx.font='10px monospace';ctx.fillText(\"\".concat(Math.floor(i/beatsPerBar)+1),x+4,12);}}// Draw playhead\nconst playheadX=currentTime/60*tempo*pixelsPerBeat;ctx.strokeStyle='#ff5500';ctx.lineWidth=2;ctx.beginPath();ctx.moveTo(playheadX,0);ctx.lineTo(playheadX,canvas.height);ctx.stroke();// Draw tracks\nconst trackHeight=Math.min(80,(canvas.height-20)/Math.max(tracks.length,1));tracks.forEach((track,index)=>{const y=20+index*trackHeight;// Track background\nctx.fillStyle=track.color+'40';ctx.fillRect(0,y,canvas.width,trackHeight-2);// Track name\nctx.fillStyle='#fff';ctx.font='11px sans-serif';ctx.fillText(track.name,8,y+16);// Draw clips (placeholder)\ntrack.clips.forEach(clip=>{const clipX=clip.startTime*pixelsPerBeat;const clipWidth=clip.duration*pixelsPerBeat;ctx.fillStyle=track.color;ctx.fillRect(clipX,y+4,clipWidth,trackHeight-10);ctx.fillStyle='#fff';ctx.font='10px sans-serif';ctx.fillText(clip.name,clipX+4,y+18);});});},[tracks,currentTime,tempo,beatsPerBar,pixelsPerBeat,pixelsPerBar]);return/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 bg-ableton-bg overflow-hidden\",children:/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,className:\"w-full h-full\",style:{display:'block'}})});};","map":{"version":3,"names":["React","useRef","useEffect","useStore","jsx","_jsx","Timeline","tracks","currentTime","tempo","timeSignature","canvasRef","beatsPerBar","pixelsPerBeat","pixelsPerBar","canvas","current","ctx","getContext","width","offsetWidth","height","offsetHeight","fillStyle","fillRect","bars","Math","ceil","i","x","isBar","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","font","fillText","concat","floor","playheadX","trackHeight","min","max","length","forEach","track","index","y","color","name","clips","clip","clipX","startTime","clipWidth","duration","className","children","ref","style","display"],"sources":["/Users/seanburdges/Documents/GitHub/iDAWi/src/components/SideA/Timeline.tsx"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport { useStore } from '../../store/useStore';\n\nexport const Timeline: React.FC = () => {\n  const { tracks, currentTime, tempo, timeSignature } = useStore();\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  // Calculate grid based on tempo and time signature\n  const beatsPerBar = timeSignature[0];\n  const pixelsPerBeat = 50;\n  const pixelsPerBar = pixelsPerBeat * beatsPerBar;\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n\n    // Set canvas size\n    canvas.width = canvas.offsetWidth;\n    canvas.height = canvas.offsetHeight;\n\n    // Draw background\n    ctx.fillStyle = '#1a1a1a';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n    // Draw grid lines\n    const bars = Math.ceil(canvas.width / pixelsPerBar);\n    for (let i = 0; i <= bars * beatsPerBar; i++) {\n      const x = i * pixelsPerBeat;\n      const isBar = i % beatsPerBar === 0;\n\n      ctx.strokeStyle = isBar ? '#444' : '#2a2a2a';\n      ctx.lineWidth = isBar ? 2 : 1;\n      ctx.beginPath();\n      ctx.moveTo(x, 0);\n      ctx.lineTo(x, canvas.height);\n      ctx.stroke();\n\n      // Bar numbers\n      if (isBar) {\n        ctx.fillStyle = '#666';\n        ctx.font = '10px monospace';\n        ctx.fillText(`${Math.floor(i / beatsPerBar) + 1}`, x + 4, 12);\n      }\n    }\n\n    // Draw playhead\n    const playheadX = (currentTime / 60) * tempo * pixelsPerBeat;\n    ctx.strokeStyle = '#ff5500';\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.moveTo(playheadX, 0);\n    ctx.lineTo(playheadX, canvas.height);\n    ctx.stroke();\n\n    // Draw tracks\n    const trackHeight = Math.min(80, (canvas.height - 20) / Math.max(tracks.length, 1));\n    tracks.forEach((track, index) => {\n      const y = 20 + index * trackHeight;\n\n      // Track background\n      ctx.fillStyle = track.color + '40';\n      ctx.fillRect(0, y, canvas.width, trackHeight - 2);\n\n      // Track name\n      ctx.fillStyle = '#fff';\n      ctx.font = '11px sans-serif';\n      ctx.fillText(track.name, 8, y + 16);\n\n      // Draw clips (placeholder)\n      track.clips.forEach(clip => {\n        const clipX = clip.startTime * pixelsPerBeat;\n        const clipWidth = clip.duration * pixelsPerBeat;\n\n        ctx.fillStyle = track.color;\n        ctx.fillRect(clipX, y + 4, clipWidth, trackHeight - 10);\n\n        ctx.fillStyle = '#fff';\n        ctx.font = '10px sans-serif';\n        ctx.fillText(clip.name, clipX + 4, y + 18);\n      });\n    });\n\n  }, [tracks, currentTime, tempo, beatsPerBar, pixelsPerBeat, pixelsPerBar]);\n\n  return (\n    <div className=\"flex-1 bg-ableton-bg overflow-hidden\">\n      <canvas\n        ref={canvasRef}\n        className=\"w-full h-full\"\n        style={{ display: 'block' }}\n      />\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}